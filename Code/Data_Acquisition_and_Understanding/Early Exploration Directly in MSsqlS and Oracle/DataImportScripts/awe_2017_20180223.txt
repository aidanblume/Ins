use flatfile ;

CREATE TABLE IF NOT EXISTS `tmp_awe_2017_20180223`
  (
health_plan	String,
mbr_site_nbr	String,
mbr_id_internal	String,
mbr_hpid	String,
mbr_last_name	String,
mbr_first_name	String,
mbr_dob	String,
mbr_gender	String,
mbr_hic_nbr	String,
encounter_id	String,
dos_from	String,
dos_thru	String,
icd_indicator	String,
icd_code_1	String,
icd_code_2	String,
icd_code_3	String,
icd_code_4	String,
icd_code_5	String,
icd_code_6	String,
icd_code_7	String,
icd_code_8	String,
icd_code_9	String,
icd_code_10	String,
icd_code_11	String,
icd_code_12	String,
icd_code_13	String,
icd_code_14	String,
icd_code_15	String,
icd_code_16	String,
icd_code_17	String,
icd_code_18	String,
icd_code_19	String,
icd_code_20	String,
icd_code_21	String,
icd_code_22	String,
icd_code_23	String,
icd_code_24	String,
icd_code_25	String,
icd_code_26	String,
icd_code_27	String,
icd_code_28	String,
icd_code_29	String,
icd_code_30	String,
pos	String,
claim_type	String,
cpt_code_1	String,
cpt_code_1_modifier	String,
cpt_code_2	String,
cpt_code_2_modifier	String,
risk_assessment_code	String,
billing_prov_id_internal	String,
billing_prov_license	String,
billing_prov_npi	String,
billing_prov_taxid	String,
billing_prov_last_name	String,
billing_prov_first_name	String,
provider_specialty_code	String,
billing_prov_street_address	String,
billing_prov_city	String,
billing_prov_state	String,
billing_prov_zip_code	String,
billing_prov_phone	String,
rendering_prov_id_internal	String,
rendering_prov_license	String,
rendering_prov_npi	String,
rendering_prov_taxid	String,
rendering_prov_last_name	String,
rendering_prov_first_name	String,
rendering_prov_street_address	String,
rendering_prov_city	String,
rendering_prov_state	String,
rendering_prov_zip_code	String,
rendering_prov_phone	String
)
ROW FORMAT DELIMITED FIELDS TERMINATED BY ','  STORED AS TEXTFILE 
LOCATION  '/user/hive/warehouse/flatfile.db/tmp_awe_2017_20180223';

CREATE EXTERNAL TABLE IF NOT EXISTS `awe_2017_20180223`(	
  `health_plan` string, 	
  `mbr_site_nbr` string, 	
  `mbr_id_internal` string, 	
  `mbr_hpid` string, 	
  `mbr_last_name` string, 	
  `mbr_first_name` string, 	
  `mbr_dob` string, 	
  `mbr_gender` string, 	
  `mbr_hic_nbr` string, 	
  `encounter_id` string, 	
  `dos_from` string, 	
  `dos_thru` string, 	
  `icd_indicator` string, 	
  `icd_code_1` string, 	
  `icd_code_2` string, 	
  `icd_code_3` string, 	
  `icd_code_4` string, 	
  `icd_code_5` string, 	
  `icd_code_6` string, 	
  `icd_code_7` string, 	
  `icd_code_8` string, 	
  `icd_code_9` string, 	
  `icd_code_10` string, 	
  `icd_code_11` string, 	
  `icd_code_12` string, 	
  `icd_code_13` string, 	
  `icd_code_14` string, 	
  `icd_code_15` string, 	
  `icd_code_16` string, 	
  `icd_code_17` string, 	
  `icd_code_18` string, 	
  `icd_code_19` string, 	
  `icd_code_20` string, 	
  `icd_code_21` string, 	
  `icd_code_22` string, 	
  `icd_code_23` string, 	
  `icd_code_24` string, 	
  `icd_code_25` string, 	
  `icd_code_26` string, 	
  `icd_code_27` string, 	
  `icd_code_28` string, 	
  `icd_code_29` string, 	
  `icd_code_30` string, 	
  `pos` string, 	
  `claim_type` string, 	
  `cpt_code_1` string, 	
  `cpt_code_1_modifier` string, 	
  `cpt_code_2` string, 	
  `cpt_code_2_modifier` string, 	
  `risk_assessment_code` string, 	
  `billing_prov_id_internal` string, 	
  `billing_prov_license` string, 	
  `billing_prov_npi` string, 	
  `billing_prov_taxid` string, 	
  `billing_prov_last_name` string, 	
  `billing_prov_first_name` string, 	
  `provider_specialty_code` string, 	
  `billing_prov_street_address` string, 	
  `billing_prov_city` string, 	
  `billing_prov_state` string, 	
  `billing_prov_zip_code` string, 	
  `billing_prov_phone` string, 	
  `rendering_prov_id_internal` string, 	
  `rendering_prov_license` string, 	
  `rendering_prov_npi` string, 	
  `rendering_prov_taxid` string, 	
  `rendering_prov_last_name` string, 	
  `rendering_prov_first_name` string, 	
  `rendering_prov_street_address` string, 	
  `rendering_prov_city` string, 	
  `rendering_prov_state` string, 	
  `rendering_prov_zip_code` string, 	
  `rendering_prov_phone` string)	
STORED AS PARQUET	
LOCATION	
  '/user/hive/warehouse/flatfile.db/awe_2017_20180223';
  
SET parquet.compression=SNAPPY;

insert overwrite table awe_2017_20180223 
SELECT  *
FROM tmp_awe_2017_20180223 ;

drop table tmp_awe_2017_20180223 purge;
